@page "/manage/hosts/edit/{HostId}"
@inject NavigationManager Navigation
@inject IHostService HostSrvc
@attribute [Authorize(Roles = "Admin")]

<link href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" rel="stylesheet">

<MudText Typo="Typo.h2">Edit host</MudText>

@if(Host != null){

    <MudItem style="width: 410px">
        <MudTextField @bind-Value="Host.DisplayName" Label="Host display name" Variant="Variant.Text" Margin="Margin.Dense"></MudTextField>
    </MudItem>


    <MudForm>
        <MudRadioGroup @bind-SelectedOption="@Host.IsWindows">
            <MudRadio Option="true" Color="Color.Primary">Windows</MudRadio>
            <MudRadio Option="false" Color="Color.Primary">Linux</MudRadio>
        </MudRadioGroup>
    </MudForm>

    <MudItem style="width: 410px">
        <MudTextField @bind-Value="Host.URI" Label="Host URI" Variant="Variant.Text" Margin="Margin.Dense"></MudTextField>
    </MudItem>

    <br />

    <MudItem>
        <MudFab Color="Color.Primary" Icon="fas fa-sync-alt" Label="Test connection" Class="py-4 px-6 rounded-lg" />
    </MudItem>

    <br />

    <MudItem>
        <MudFab Color="Color.Primary" Icon="@Icons.Filled.Save" Label="Save" Class="py-4 px-6 rounded-lg" OnClick="SaveChanges"/>
    </MudItem>
}



@code {
    
    
    [Parameter]
    public string HostId { get; set; }
    public HostModel Host { get; set; }

    protected override async Task OnParametersSetAsync()
    {
        Host = await HostSrvc.HostDetails(HostId);
    }


    private async Task SaveChanges()
    {
        await HostSrvc.EditHost(Host);
        Navigation.NavigateTo("/manage/hosts");
    }

}
